#! /bin/bash

minimserver_dir=$(readlink -f "$(dirname $(which $0))/..")

images=( docker.io/java:8-jre )

if ${minimserver_dir}/../../bin/check-images-need-update ${images[@]} ; then
    cd "${minimserver_dir}"
    docker build --no-cache -t "minimserver" -proxy --pull  .
    docker-compose down
    docker-compose up -d

    echo "Navidrome docker has been updated." 1>&2
else
    echo "Image SHA hasn't changed, keeping the container running." 1>&2
fi
